<!DOCTYPE html><html><head><meta charset="utf-8"><title>Taller de Análisis de Log.md.html</title><style></style></head><body id="preview">
<h1><a id="Taller_de_Anlisis_de_Log_0"></a>Taller de Análisis de Log</h1>
<hr>
<h2><a id="Bienvenido_estudiante_2"></a>Bienvenido estudiante!</h2>
<p>Primero que todo, muchas gracias por querer participar de este Evento llamado <a href="https://partyhack.cl/fraternity"><strong>Fraternity</strong></a> de <a href="http://Partyhack.cl">Partyhack.cl</a>! Tu apoyo es crucial e importante para la gran cruzada que tenemos por delante.</p>
<p>Para poder disfrutar y sacar el mayor provecho de este taller es necesario que vayas preparado, tengas tu equipo y, si te da el tiempo, haber estudiado algunas cosas previas para agilizar la parte teórica!</p>
<p>En esta guía prepararemos nuestro computador para hacer la parte práctica del taller. Así que bienvenido y si tienes cualquier duda me puedes ubicar en Telegram bajo el nick de <a href="https://t.me/mdiazcl"><strong>@MdiazCL - Telegram</strong></a> o preguntarme vía Twitter en <a href="https://twitter.com/mdiazcl"><strong>@mdiazcl</strong></a>.</p>
<h2><a id="Requerimientos_de_computador_9"></a>Requerimientos de computador</h2>
<p>Para este laboratorio vamos a utilizar un set de herramientas que nos permitirán almacenar, procesar y analizar datos, por lo que tu computador debe tener las capacidades para correr estas herramientas! Como mínimo te recomiendo contar con una máquina con las siguientes características.</p>
<p><strong>Requerimientos mínimos</strong></p>
<ul>
<li><strong>Procesador:</strong> Procesador de 4 núcleos (x64) sobre 2.0ghz</li>
<li><strong>Memoria Ram:</strong> 8gb o más</li>
<li><strong>Disco Duro:</strong> 50gb (si usas VM usa espacio dinámico)</li>
<li><strong>Software:</strong> Java v1.8</li>
<li><strong>Sistema Operativo:</strong> Debian/Ubuntu</li>
</ul>
<p><strong>Nota importante si vas a usar Windows</strong><br>
Te aconsejo correr esto en una máquina virtual con Linux, no tengo experiencia corriendo las herramientas en entornos Windows. Según la página de <a href="https://www.elastic.co/">https://www.elastic.co/</a> todo debería funcionar, sin embargo si tienes problemas, intentaré ayudarte! Pero no prometo nada.</p>
<p><strong>Si usarás otra distribución de Linux</strong><br>
Si utilizarás alguna otra distribución de Linux, tan solo realiza los cambios de los comandosp por los que pertenecen a ese sistemas operativo. Los comandos que usaremos son bastante nativos por lo que no deberían haber muchos problemas.</p>
<h2><a id="Instalacin_de_herramientas_28"></a>Instalación de herramientas</h2>
<hr>
<p>Para este laboratorio utilizaremos 5 herramientas!</p>
<ul>
<li><strong>ElasticSearch v6</strong> - Una base de datos tipo Full-text Search</li>
<li><strong>Kibana v6</strong> - Un visualizador de datos</li>
<li><strong>Logstash v6</strong> - Un normalizador/preparador de datos</li>
<li><strong>Navegador Web</strong> (Firefox o Chrome) - Para navegar por el kibana</li>
<li><strong>Java v8 Minimo</strong></li>
</ul>
<p>Utilizaremos la versión community de estas herramientas! Por lo que no hay que adquirir ninguna licencia o algún requerimiento inicial. Verás que instalarla tomará minutos!</p>
<p>Primero que todo, chequiemos en una terminal que tenemos los requerimientos necesarios para ejecutar el Stack ELK (Elasticsearch, Logstash y Kibana).</p>
<p>En un terminal ejecuta lo siguiente:</p>
<pre><code class="language-bash">java -version
</code></pre>
<p>La empresa <a href="http://Elastic.co">Elastic.co</a> recomienda tener instalada la versión <strong>1.8.0_131</strong> o superior, ya que el programa reclamará si no tienes la versión suficiente. Si no la tienes instalada te recomienda descargarla e instalarla <a href="https://www.oracle.com/technetwork/java/javase/downloads/jre8-downloads-2133155.html">directamente del sitio de Java</a>.</p>
<p>Una vez que la versión de java está comprobada y lista, descarguemos los ejecutables directamente desde la página de Elastic.</p>
<h2><a id="Instalacin_de_OpenJDK_8_53"></a>Instalación de OpenJDK 8**</h2>
<hr>
<p><strong>(Gracias Felipe Castañeda por el aporte!)</strong><br>
Java 8 es la versión actual de soporte a largo plazo y aún es ampliamente compatible, aunque el mantenimiento público finaliza en enero de 2019. Para instalar OpenJDK 8, ejecute el siguiente comando:</p>
<pre><code class="language-shell">sudo apt install openjdk-8-jdk
</code></pre>
<p>Verifique que esto está instalado con</p>
<pre><code class="language-shell">java -version
</code></pre>
<p>Verás una salida como esta:</p>
<pre><code>openjdk version &quot;1.8.0_162&quot;
OpenJDK Runtime Environment (build 1.8.0_162-8u162-b12-1-b12)
OpenJDK 64-Bit Server VM (build 25.162-b12, mixed mode)
</code></pre>
<hr>
<p><strong>Importante:</strong> para los usuarios de ubuntu están disponibles los paquetes de Debian .DEB (incluso lo puedes instalar vía APT), sin embargo <strong>no te recomiendo seguir este método</strong> a menos que tengas experiencia, ya que es mas facil manejar todo directamente desde la carpeta en la que descomprimiremos todo!</p>
<hr>
<h2><a id="Instalacin_del_Stack_ELK_78"></a>Instalación del Stack ELK</h2>
<p>Crear una carpeta para almacenar todas las descargas y descargar lo necesario.</p>
<pre><code class="language-bash">mkdir ~/elk/
<span class="hljs-built_in">cd</span> ~/elk/

wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-<span class="hljs-number">6.4</span>.<span class="hljs-number">2</span>.tar.gz
wget https://artifacts.elastic.co/downloads/kibana/kibana-<span class="hljs-number">6.4</span>.<span class="hljs-number">2</span>-linux-x86_64.tar.gz
wget https://artifacts.elastic.co/downloads/logstash/logstash-<span class="hljs-number">6.4</span>.<span class="hljs-number">2</span>.tar.gz
</code></pre>
<p>Una vez descargados los archivos, descomrpimir en sus respectivas carpetas.</p>
<pre><code class="language-bash">tar -xvzf elasticsearch-<span class="hljs-number">6.4</span>.<span class="hljs-number">2</span>.tar.gz
tar -xvzf kibana-<span class="hljs-number">6.4</span>.<span class="hljs-number">2</span>-linux-x86_64.tar.gz
tar -xvzf logstash-<span class="hljs-number">6.4</span>.<span class="hljs-number">2</span>.tar.gz
</code></pre>
<p>Esto creará tres carpetas distintas, con los respectivos archivos descomprimidos. Primero, vamos a configurar Elasticsearch!</p>
<p><strong>Asignando más memoria a ElasticSearch</strong><br>
Nuestra primera meta es entregarle más utilización de RAM a ElasticSearch, ya que no es una guía detallada en el uso completo del a tecnología iremos directo al grano!</p>
<p><em>Configurar el archivo <strong>jvm.options:</strong></em></p>
<pre><code class="language-bash"><span class="hljs-built_in">cd</span> elasticsearch-<span class="hljs-number">6.4</span>.<span class="hljs-number">2</span>/config
vim jvm.options
</code></pre>
<p>En este archivo, buscar la línea donde está especificado la cantidad de Ram a utilizar (mínima y máxima) y  subirla a 4gb (o más si puedes).</p>
<pre><code class="language-diff"><span class="hljs-deletion">-Xms1g   # cambiar por -Xms4g</span>
<span class="hljs-deletion">-Xmx1g   # cambiar por -Xmx4g</span>
</code></pre>
<p>Con esto deberia estár listo una instalación básica de Elasticsearch!</p>
<h2><a id="Corriendo_las_herramientas_115"></a>Corriendo las herramientas</h2>
<hr>
<p>Con lo anterior, todo deberia estar en orden! Revisemos y ejecutemos las herramientas. Para hacerlo, abre 3 terminales distintos (o usa Tmux si sabes usarlo!).</p>
<h3><a id="Ejecutando_Elasticsearch_119"></a>Ejecutando Elasticsearch</h3>
<p>Ubicate en la carpeta de Elasticsearch y ejecuta el software.</p>
<pre><code class="language-bash"><span class="hljs-built_in">cd</span> ~/elk/elasticsearch-<span class="hljs-number">6.4</span>.<span class="hljs-number">2</span>/bin
./elasticsearch
</code></pre>
<p>El output debería cargar un montón de librerias, sin embargo al final debería decir algo parecido a esto:</p>
<pre><code class="language-output">[2018-10-13T20:18:07,624][INFO ][o.e.t.TransportService   ] [-utqMZo] publish_address {127.0.0.1:9300}, bound_addresses {[::1]:9300}, {127.0.0.1:9300}
</code></pre>
<p>Sin embargo, podemos comprobar que Elasticsearch está corriendo correctamente en el browser accediendo a la siguente dirección: <a href="http://127.0.0.1:9200">http://127.0.0.1:9200</a> y nos debería entregar los datos correspondientes a la versión instalada:</p>
<pre><code class="language-json">{
  "<span class="hljs-attribute">name</span>" : <span class="hljs-value"><span class="hljs-string">"-utqMZo"</span></span>,
  "<span class="hljs-attribute">cluster_name</span>" : <span class="hljs-value"><span class="hljs-string">"elasticsearch"</span></span>,
  "<span class="hljs-attribute">cluster_uuid</span>" : <span class="hljs-value"><span class="hljs-string">"iQ60l9wtTmiJSy0i6RbfLw"</span></span>,
  "<span class="hljs-attribute">version</span>" : <span class="hljs-value">{
    "<span class="hljs-attribute">number</span>" : <span class="hljs-value"><span class="hljs-string">"6.4.2"</span></span>,
    "<span class="hljs-attribute">build_flavor</span>" : <span class="hljs-value"><span class="hljs-string">"default"</span></span>,
    "<span class="hljs-attribute">build_type</span>" : <span class="hljs-value"><span class="hljs-string">"tar"</span></span>,
    "<span class="hljs-attribute">build_hash</span>" : <span class="hljs-value"><span class="hljs-string">"04711c2"</span></span>,
    "<span class="hljs-attribute">build_date</span>" : <span class="hljs-value"><span class="hljs-string">"2018-09-26T13:34:09.098244Z"</span></span>,
    "<span class="hljs-attribute">build_snapshot</span>" : <span class="hljs-value"><span class="hljs-literal">false</span></span>,
    "<span class="hljs-attribute">lucene_version</span>" : <span class="hljs-value"><span class="hljs-string">"7.4.0"</span></span>,
    "<span class="hljs-attribute">minimum_wire_compatibility_version</span>" : <span class="hljs-value"><span class="hljs-string">"5.6.0"</span></span>,
    "<span class="hljs-attribute">minimum_index_compatibility_version</span>" : <span class="hljs-value"><span class="hljs-string">"5.0.0"</span>
  </span>}</span>,
  "<span class="hljs-attribute">tagline</span>" : <span class="hljs-value"><span class="hljs-string">"You Know, for Search"</span>
</span>}
</code></pre>
<p>Listo! <strong>No cierres este terminal.</strong></p>
<h3><a id="Ejecutando_Kibana_157"></a>Ejecutando Kibana</h3>
<p>Ubícate en la carpeta de Kibana y ejecuta el software.</p>
<pre><code class="language-bash"><span class="hljs-built_in">cd</span> ~/elk/kibana-<span class="hljs-number">6.4</span>.<span class="hljs-number">2</span>-linux-x86_64/bin
./kibana
</code></pre>
<p>El output debería decirte algo como:</p>
<pre><code>log   [23:18:14.443] [info][listening][server][http] Server running at http://localhost:5601
</code></pre>
<p>Sin embargo, si resulta todo bien, deberiamos tener el Kibana corriendo en el puerto 5601! Entra al siguente enlace para comprobar: <a href="http://127.0.0.1:5601">http://127.0.0.1:5601</a> y debería mostrar la interfaz de Kibana! Asegurate que no haya ningún error!</p>
<p>Tampoco cierres el terminal!</p>
<h3><a id="Ejecutando_Logstash_176"></a>Ejecutando Logstash</h3>
<pre><code class="language-bash"><span class="hljs-built_in">cd</span> ~/elk/logstash-<span class="hljs-number">6.4</span>.<span class="hljs-number">2</span>/bin
./logstash
</code></pre>
<p>Ya que no le hemos dado ningún archivo de configuración al logstash (No te preocupes! lo haremos en el laboratorio). Enviará un error parecido al siguiente</p>
<pre><code>ERROR: Pipelines YAML file is empty.
</code></pre>
<p>Con esto deberias tener todo listo y corriendo para el taller!</p>
<h2><a id="Dudas_191"></a>Dudas?</h2>
<hr>
<p>Recuerda que si tienes dudas o algo no te resulta estaré dando apoyo a los asistentes durante la semana previa al laboratorio! Me ubican en Telegram o Twitter.</p>
<p>@mdiazcl</p>
<p>Saludos!<br>
Espero que lo disfruten,</p>
<p>_ Miguel Díaz _</p>

</body></html>
